$(document).ready(function(){function e(){$.ajax({type:"post",url:`${u}/student_single/get_student_info`,dataType:"json",data:{pin:pin},success:function(e){var t,s="",n="";for(t=0;t<e.length;t++)n+=`<a title="Edit student and course detail" href="javascript:void(0);" class="btn btn-info btn-sm tooltip-bottom student_info_edit" data-grp="${e[t].grp}" data-pn="${e[t].pin}" data-cn="${e[t].complete_name}" data-nn="${e[t].nick_name}" data-ad="${e[t].address}" data-pb="${e[t].place_of_birth}" data-db="${$.format.date(e[t].date_of_birth,"yyyy-MM-dd")}" data-ph="${e[t].phone}" data-cnst2="${e[t].cnst2}" data-nnst2="${e[t].nnst2}" data-adrst2="${e[t].adrst2}" data-pobst2="${e[t].pobst2}" data-dobst2="${$.format.date(e[t].dobst2,"yyyy-MM-dd")}" data-phst2="${e[t].phst2}" data-cnst3="${e[t].cnst3}" data-nnst3="${e[t].nnst3}" data-adrst3="${e[t].adrst3}" data-pobst3="${e[t].pobst3}" data-dobst3="${$.format.date(e[t].dobst3,"yyyy-MM-dd")}" data-phst3="${e[t].phst3}" data-cnst4="${e[t].cnst4}" data-nnst4="${e[t].nnst4}" data-adrst4="${e[t].adrst4}" data-pobst4="${e[t].pobst4}" data-dobst4="${$.format.date(e[t].dobst4,"yyyy-MM-dd")}" data-phst4="${e[t].phst4}" data-pr="${e[t].program}" data-pd="${e[t].program_duration}" data-sd="${$.format.date(e[t].starting_date,"yyyy-MM-dd")}" data-re="${e[t].reason}" data-ta="${e[t].target}" data-di="${e[t].difficulties}" data-bg="${e[t].bground}" data-si="${e[t].self_introduction}" data-wp="${e[t].weakness_point}" data-ap="${e[t].action_plan}" data-fsp="${e[t].fsp}"><i class="fas fa-user-edit fa-fw"></i></a>`,s+=`  <div class="card">
                      <div class="card-header" id="heading_student">
                        <h2 class="mb-0">
                          <button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse_student" aria-expanded="true" aria-controls="collapse_student">
                            PERSONAL INFORMATION
                          </button>
                        <span class="float-right" id="edit_student_span"></span>
                        </h2>
                      </div>

                      <div id="collapse_student" class="collapse show" aria-labelledby="heading_student" data-parent="#student_info">
                        <div class="card-body">`,s+=""!=e[t].grp?`<li class="list-group-item tooltip-bottom" title="Group study" style="background-color:gray;color:white;">${e[t].grp}</li>`:``,s+=`<span class="student_info_item"> PIN :</span>${e[t].pin}<br>
                        <span class="student_info_item"> Name:</span>  ${e[t].complete_name}, ${e[t].nick_name}<br>
                        <span class="student_info_item">   Address:</span>${e[t].address} <br>
                        <span class="student_info_item">   PDoB:</span>${e[t].place_of_birth}, ${$.format.date(e[t].date_of_birth,"yyyy-MM-dd")} <br>
                        <span class="student_info_item">   Phone:</span> ${e[t].phone}<br>
                        </div>
                      </div>
                    </div>`,""!=e[t].cnst2&&(s+=`<div class="card">
                  <div class="card-header" id="heading_student2">
                    <h2 class="mb-0">
                      <button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse_student2" aria-expanded="true" aria-controls="collapse_student2">
                      STUDENT 2
                      </button>
                    </h2>
                  </div>
                  <div id="collapse_student2" class="collapse" aria-labelledby="heading_student2" data-parent="#student_info">
                    <div class="card-body">
                      <span class="student_info_item"> Name :</span> ${e[t].cnst2}, ${e[t].nnst2}<br>
                      <span class="student_info_item"> Address:</span> ${e[t].adrst2}<br>
                      <span class="student_info_item"> PDoB:</span> ${e[t].pobst2}, ${$.format.date(e[t].dobst2,"yyyy-MM-dd")}<br>
                      <span class="student_info_item"> Phone:</span> ${e[t].phst2}<br>
                    </div>
                  </div>
                </div>`),""!=e[t].cnst3&&(s+=`<div class="card">
                  <div class="card-header" id="heading_student3">
                    <h2 class="mb-0">
                      <button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse_student3" aria-expanded="true" aria-controls="collapse_student3">
                      STUDENT 3
                      </button>
                    </h2>
                  </div>
                  <div id="collapse_student3" class="collapse" aria-labelledby="heading_student3" data-parent="#student_info">
                    <div class="card-body">
                      <span class="student_info_item"> Name :</span> ${e[t].cnst3}, ${e[t].nnst3}<br>
                      <span class="student_info_item"> Address:</span> ${e[t].adrst3}<br>
                      <span class="student_info_item"> PDoB:</span> ${e[t].pobst3}, ${$.format.date(e[t].dobst3,"yyyy-MM-dd")}<br>
                      <span class="student_info_item"> Phone:</span> ${e[t].phst3}<br>
                    </div>
                  </div>
                </div>`),""!=e[t].cnst4&&(s+=`<div class="card">
                  <div class="card-header" id="heading_student4">
                    <h2 class="mb-0">
                      <button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse_student4" aria-expanded="true" aria-controls="collapse_student4">
                      STUDENT 4
                      </button>
                    </h2>
                  </div>
                  <div id="collapse_student4" class="collapse" aria-labelledby="heading_student4" data-parent="#student_info">
                    <div class="card-body">
                      <span class="student_info_item"> Name :</span> ${e[t].cnst3}, ${e[t].nnst3}<br>
                      <span class="student_info_item"> Address:</span> ${e[t].adrst3}<br>
                      <span class="student_info_item"> PDoB:</span> ${e[t].pobst3}, ${$.format.date(e[t].dobst3,"yyyy-MM-dd")}<br>
                      <span class="student_info_item"> Phone:</span> ${e[t].phst3}<br>
                    </div>
                  </div>
                </div>`),s+=`<div class="card">
                      <div class="card-header" id="heading_course_detail">
                        <h2 class="mb-0">
                          <button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse_course_detail" aria-expanded="true" aria-controls="collapse_course_detail">
                            COURSE DETAIL
                          </button>
                        </h2>
                      </div>

                      <div id="collapse_course_detail" class="collapse" aria-labelledby="heading_course_detail" data-parent="#student_info">
                        <div class="card-body">
                    <span class="student_info_item"> Program:</span>${e[t].program}<br>
                    <span class="student_info_item"> Program duration: </span>${e[t].program_duration}<br>
                    <span class="student_info_item"> Started on:</span>${$.format.date(e[t].starting_date,"MMM,dd yyyy")} <br>
                    <span class="student_info_item"> Reason:</span> ${e[t].reason}<br>
                    <span class="student_info_item"> Target:</span> ${e[t].target}<br>
                    <span class="student_info_item"> Difficulties:</span> ${e[t].difficulties}<br>
                    <span class="student_info_item"> Background:</span> ${e[t].bground}<br>
                    <span class="student_info_item"> Self Introduction:</span> ${e[t].self_introduction}<br>
                    <span class="student_info_item"> Weakness points: </span>  ${e[t].action_plan}<br>
                    <span class="student_info_item"> Action Plan: </span> ${e[t].action_plan}

                        </div>
                      </div>
                    </div>`,"yes"==e[t].fsp&&($("#fsp_tab").css("display","block"),a());$("#student_info").html(s),$("#edit_student_span").html(n)}})}function t(t,a,s,n,d,c,l,o,r,i,p,m,_,f,h,b,v,y,g,k,M,w,x,C,j,T,O,N,P,S,I,D,q,J,H,A,E){$.ajax({type:"post",url:`${u}/student/update`,dataType:"json",data:{pn:t,cn:a,nn:s,ad:n,pb:d,db:c,ph:l,grp:o,cn2:r,nn2:i,ad2:p,pb2:m,db2:_,ph2:f,cn3:h,nn3:b,ad3:v,pb3:y,db3:g,ph3:k,cn4:M,nn4:w,ad4:x,pb4:C,db4:j,ph4:T,pr:O,pd:N,sd:P,re:S,ta:I,di:D,bg:q,si:J,wp:H,ap:A,fsp:E},success:function(t){$("#esm").modal("hide"),$("#mystudents").DataTable().ajax.reload(),e()}})}function a(){$.ajax({url:`${u}/student_single/get_fsp`,type:"post",dataType:"JSON",data:{pin:pin},success:function(e){var t,a="";for(t=0;t<e.length;t++)a+="<tr><td>"+e[t].id+"</td><td>"+e[t].material+"</td>",a+="good"==e[t].fsp_result?'<td><i style="color:blue;" class="fas fa-check-square fa-2x"></i></td>':"<td></td>",a+="average"==e[t].fsp_result?'<td><i style="color:blue;" class="fas fa-check-square fa-2x"></i></td>':"<td></td>",a+="need_improvement"==e[t].fsp_result?'<td><i style="color:blue;" class="fas fa-check-square fa-2x"></i></td>':"<td></td>",a+=`<td>${e[t].comment}</td>
                      <td>
                        <a class="fsp_item_edit btn btn-warning btn-sm" href="javascript:void(0);"
                          data-id="${e[t].id}"
                          data-fsp_result="${e[t].fsp_result}"
                          data-material="${e[t].material}"
                          data-comment="${e[t].comment}">
                          <i class="fas fa-pencil-alt fa-fw"></i>
                        </a>
                      </td>
                    </tr>`;$("#fsp_data").html(a)}})}function n(e,t,a,s,n,d,l,o,r,i,p,m,_,f,h,b){$.ajax({type:"POST",url:`${u}/student_single/save_course`,dataType:"JSON",data:{p:e,m:t,cd:a,tc:s,du:n,ma:d,co:l,ev:o,w:r,s:i,test:p,tnu:m,tn:_,otn:f,ot:h},success:function(t){$('[name="me"]').val(""),$('[name="tc"]').val(""),$('[name="du"]').val(""),$('[name="ma"]').val(""),$('[name="co"]').val(""),$('[name="ev"]').val(""),$('[name="wr"]').val(""),$('[name="sp"]').val(""),$('[name="test"]').val(""),$('[name="tnu"]').val(""),$('[name="tn"]').val(""),$('[name="otn"]').val(""),$('[name="ot"]').val(""),$("#course_form").fadeOut("slow"),$("#mycourse").DataTable().ajax.reload(),c(e,b)}})}function d(e,t){$.ajax({type:"POST",url:`${u}/student_single/create_test`,dataType:"JSON",data:{pin:e,meeting:t},success:function(e){$("#my_tests").DataTable().ajax.reload()}})}function c(t,a){$.ajax({type:"POST",url:`${u}/student_single/set_aft`,dataType:"JSON",data:{pin:t,after_teaching:a},success:function(t){e()}})}function l(e){return e=e.replace(/<br>|<br \/>/gm,"\n\n"),e=e.replace(/<p>/gm,"\n"),e=e.replace(/<\/p>/gm,"\n"),e=e.replace(/<em>|<i>/gm,"_"),e=e.replace(/<\/em>|<\/i>/gm,"_"),e=e.replace(/<b>|<strong>/gm,"**"),e=e.replace(/<\/b>|<\/strong>/gm,"**"),e=e.replace(/<code>/gm,"`"),e=e.replace(/<\/code>/gm,"`"),e=e.replace(/<h6>/gm,"######"),e=e.replace(/<h5>/gm,"#####"),e=e.replace(/<h4>/gm,"####"),e=e.replace(/<h3>/gm,"###"),e=e.replace(/<h2>/gm,"##"),e=e.replace(/<h1>/gm,"#"),e=e.replace(/<\/h6>|<\/h5>|<\/h4>|<\/h3>|<\/h2>|<\/h1>|/gm,""),e=e.replace(/<(ul|ol)\b[^>]*>([\s\S]*?)<\/\1>/gi,function(e,t,a){var s=a.split("</li>");for(s.splice(s.length-1,1),i=0,len=s.length;i<len;i++)if(s[i]){var n="ol"===t?i+1+". ":"* ";s[i]=s[i].replace(/\s*<li[^>]*>([\s\S]*)/i,function(e,t){return t=t.replace(/^\s+/,""),t=t.replace(/\n\n/g,"\n\n    "),t=t.replace(/\n([ ]*)+(\*|\d+\.) /g,"\n$1    $2 "),n+t})}return s.join("\n")}),e.replace(/[ \t]+\n|\s+$/g,"")}function o(e,t,a,s,n,d,c,l,o,r,i,p,m,_,f){$.ajax({type:"POST",url:`${u}/student_single/update_course`,dataType:"JSON",data:{p:e,m:t,cd:a,tc:s,du:n,ma:d,co:c,ev:l,w:o,s:r,test:i,tnu:p,tn:m,otn:_,ot:f},success:function(e){$("#course_form").fadeOut("slow"),$("#mycourse").DataTable().ajax.reload(),$("#mytests").DataTable().ajax.reload()}})}function r(e,t){$.ajax({type:"post",url:`${u}/student_single/delete_test`,dataType:"json",data:{pin:e,m:t},success:function(e){console.log("test deleted")}})}function p(e,t){$.ajax({type:"post",url:`${u}/student_single/delete_course`,dataType:"json",data:{pin:e,m:t},success:function(e){console.log("course deleted")}})}e(),$("#cheatsheet_button").on("click",function(){$("#cheatsheet_box").toggle("fast"),$("#cheatsheet_close").on("click",function(){$("#cheatsheet_box").fadeOut("slow")})}),$("#student_info").on("click",".student_info_edit",function(){var e=$(this).data("grp"),t=$(this).data("pn"),a=$(this).data("cn"),s=$(this).data("nn"),n=$(this).data("ad"),d=$(this).data("pb"),c=$(this).data("db"),l=$(this).data("ph"),o=$(this).data("cnst2"),r=$(this).data("nnst2"),i=$(this).data("adrst2"),u=$(this).data("pobst2"),p=$(this).data("dobst2"),m=$(this).data("phst2"),_=$(this).data("cnst3"),f=$(this).data("nnst3"),h=$(this).data("adrst3"),b=$(this).data("pobst3"),v=$(this).data("dobst3"),y=$(this).data("phst3"),g=$(this).data("cnst4"),k=$(this).data("nnst4"),M=$(this).data("adrst4"),w=$(this).data("pobst4"),x=$(this).data("dobst4"),C=$(this).data("phst4"),j=$(this).data("pr"),T=$(this).data("pd"),O=$(this).data("sd"),N=$(this).data("re"),P=$(this).data("ta"),S=$(this).data("di"),I=$(this).data("bg"),D=$(this).data("si"),q=$(this).data("wp"),J=$(this).data("ap"),H=$(this).data("fsp"),A='<input type="checkbox" name="fsp" id="fsp"';$("#esm").modal("show"),$('[name="pn_e"]').val(t),$('[name="cn_e"]').val(a),$('[name="nn_e"]').val(s),$('[name="ad_e"]').val(n),$('[name="pb_e"]').val(d),$('[name="db_e"]').val(c),$('[name="ph_e"]').val(l),$('[name="grp_e"]').val(e),$('[name="cnst2_e"]').val(o),$('[name="nnst2_e"]').val(r),$('[name="adrst2_e"]').val(i),$('[name="pbst2_e"]').val(u),$('[name="dbst2_e"]').val(p),$('[name="phst2_e"]').val(m),$('[name="cnst3_e"]').val(_),$('[name="nnst3_e"]').val(f),$('[name="adrst3_e"]').val(h),$('[name="pbst3_e"]').val(b),$('[name="dbst3_e"]').val(v),$('[name="phst3_e"]').val(y),$('[name="cnst4_e"]').val(g),$('[name="nnst4_e"]').val(k),$('[name="adrst4_e"]').val(M),$('[name="pbst4_e"]').val(w),$('[name="dbst4_e"]').val(x),$('[name="phst4_e"]').val(C),$('[name="pr2"]').val(j),$('[name="pd2"]').val(T),$('[name="sd2"]').val(O),$('[name="re2"]').val(N),$('[name="ta2"]').val(P),$('[name="di2"]').val(S),$('[name="bg2"]').val(I),$('[name="si2"]').val(D),$('[name="wp2"]').val(q),$('[name="ap2"]').val(J),""==o?$("#group_name_e, #student2_e, #student3_e, #student4_e").css("display","none"):""==_?($("#group_name_e,#student2_e").css("display","block"),$("#student3_e,#student4_e").css("display","none")):""==g?($("#group_name_e,#student2_e,#student3_e").css("display","block"),$("#student4_e").css("display","none")):$("#group_name_e,#student2_e,#student3_e,#student4_e").css("display","block"),$("#add_one_e").on("click",function(){$("#group_name_e,#student2_e").fadeIn("slow"),$("#group_name_e,#student2_e").css("display","block")}),$("#add_two_e").on("click",function(){$("#student3_e").fadeIn("slow"),$("#student3_e").css("display","block")}),$("#remove_three_e").on("click",function(){$("#group_name_e,#student2_e,#student3_e,#student4_e").fadeOut("fast")}),$("#add_three_e").on("click",function(){$("#student4_e").fadeIn("slow"),$("#student4_e").css("display","block")}),$("#remove_two_e").on("click",function(){$("#student3_e,#student4_e").fadeOut("fast")}),$("#remove_one_e").on("click",function(){$("#student4_e").fadeOut("fast")}),A+="yes"==H?'checked disabled> <label for="fsp">Final Speaking Performance</label>':'> <label for="fsp">Final Speaking Performance</label>',$("#fsp_button").html(A)}),$("#update_student_btn").on("click",function(){var e="background-color",a="#fbe2e6",s=$("#pn_e").val(),n=$("#cn_e").val(),d=$("#nn_e").val(),c=$("#ad_e").val(),l=$("#pb_e").val(),o=$("#db_e").val(),r=$("#ph_e").val(),i=$("#grp_e").val(),u=$("#cnst2_e").val(),p=$("#nnst2_e").val(),m=$("#adrst2_e").val(),_=$("#pbst2_e").val(),f=$("#dbst2_e").val(),h=$("#phst2_e").val(),b=$("#cnst3_e").val(),v=$("#nnst3_e").val(),y=$("#adrst3_e").val(),g=$("#pbst3_e").val(),k=$("#dbst3_e").val(),M=$("#phst3_e").val(),w=$("#cnst4_e").val(),x=$("#nnst4_e").val(),C=$("#adrst4_e").val(),j=$("#pbst4_e").val(),T=$("#dbst4_e").val(),O=$("#phst4_e").val(),N=$("#pr2").val(),P=$("#pd2").val(),S=$("#sd2").val(),I=$("#re2").val(),D=$("#ta2").val(),q=$("#di2").val(),J=$("#bg2").val(),H=$("#si2").val(),A=$("#wp2").val(),E=$("#ap2").val(),R="";R=$("#fsp").is(":checked")?"yes":"",""==n||""==c||""==o||""==r||""==N||""==P?($("#esf").addClass("alert alert-danger"),$("#esf").html("Please fill out all required fields"),""==n&&$("#cn_e").css(e,a),""==c&&$("#ad_e").css(e,a),""==o&&$("#db_e").css(e,a),""==r&&$("#ph_e").css(e,a),""==N&&$("#pr_e").css(e,a),""==P&&$("#pd_e").css(e,a)):isNaN(r)?($("#esf").addClass("alert alert-danger"),$("#esf").html("Phone must only be number!"),$("#ph_e").css(e,a)):isNaN(P)?($("#esf").addClass("alert alert-danger"),$("#esf").html("Program duration must only be number!"),$("#pd_e").css(e,a)):"block"===$("#student2_e").css("display")?""==u||""==m||""==f||""==h?($("#esf").addClass("alert alert-danger"),$("#esf").html("Please fill out all required fields!"),""==u&&$("#cnst2_e").css(e,a),""==m&&$("#adrst2_e").css(e,a),""==f&&$("#dbst2_e").css(e,a),""==h&&$("#phst2_e").css(e,a)):isNaN(h)?($("#esf").addClass("alert alert-danger"),$("#esf").html("Phone must only be number!"),$("#phst2_e").css(e,a)):"block"===$("#student3_e").css("display")?""==b||""==y||""==k||""==M?($("#esf").addClass("alert alert-danger"),$("#esf").html("Please fill out all required fields!"),""==b&&$("#cnst3_e").css(e,a),""==y&&$("#adrst3_e").css(e,a),""==k&&$("#dbst3_e").css(e,a),""==M&&$("#phst3_e").css(e,a)):isNaN(M)?($("#esf").addClass("alert alert-danger"),$("#esf").html("Phone must only be number!"),$("#phst3_e").css(e,a)):"block"===$("#student4_e").css("display")?""==w||""==C||""==T||""==O?($("#esf").addClass("alert alert-danger"),$("#esf").html("Please fill out all required fields!"),""==w&&$("#cnst4_e").css(e,a),""==C&&$("#adrst4_e").css(e,a),""==T&&$("#dbst4_e").css(e,a),""==O&&$("#phst4_e").css(e,a)):isNaN(O)?($("#esf").addClass("alert alert-danger"),$("#esf").html("Phone must only be number!"),$("#phst4_e").css(e,a)):t(s,n,d,c,l,o,r,i,u,p,m,_,f,h,b,v,y,g,k,M,w,x,C,j,T,O,N,P,S,I,D,q,J,H,A,E,R):(w=x=j=C=O=T="",t(s,n,d,c,l,o,r,i,u,p,m,_,f,h,b,v,y,g,k,M,w,x,C,j,T,O,N,P,S,I,D,q,J,H,A,E,R)):(b=v=g=y=M=k=w=x=j=C=O=T="",t(s,n,d,c,l,o,r,i,u,p,m,_,f,h,b,v,y,g,k,M,w,x,C,j,T,O,N,P,S,I,D,q,J,H,A,E,R)):(u=p=_=m=h=f=b=v=g=y=M=k=w=x=j=C=O=T="",t(s,n,d,c,l,o,r,i,u,p,m,_,f,h,b,v,y,g,k,M,w,x,C,j,T,O,N,P,S,I,D,q,J,H,A,E,R))}),$("#mycourse").DataTable({responsive:!0,ajax:{url:`${u}/student_single/get_course?pin=${pin}`,dataSrc:""},columns:[{data:"meeting"},{data:"course_date",render:function(e,t,a){return $.format.date(e,"E, MMM/dd/yy, H:mm")}},{data:"teacher"},{data:"duration",render:function(e,t,a,s){return e+" minutes"}},{data:{material:"material",co:"co"},render:function(e,t,a){return null==e.co||0==e.co?e.material:`${e.material}<br><br><span class="badge badge-pill badge-warning">${e.co}</span>`}},{data:"evaluation"},{data:"w"},{data:"s"},{data:{meeting:"meeting",course_date:"course_date",teacher:"teacher",duration:"duration",material:"material",co:"co",evaluation:"evaluation",w:"w",s:"s",test:"test",test_number:"test_number",test_name:"test_name",of_test_number:"of_test_number",of_test:"of_test"},render:function(e,t,a,s){return`<a title="Edit" href="javascript:void(0);" class="btn btn-info btn-sm item_edit tooltip-right" data-m="${e.meeting}" data-cd="${e.course_date}" data-tc="${e.teacher}" data-du="${e.duration}" data-ma="${e.material}" data-co="${e.co}" data-ev="${e.evaluation}" data-w="${e.w}" data-s="${e.s}" data-test="${e.test}" data-tnu="${e.test_number}" data-tn="${e.test_name}" data-otn="${e.of_test_number}" data-ot="${e.of_test}"><i class="fas fa-pencil-alt fa-fw"></i></a> <a href="javascript:void(0);" title="delete" class="btn btn-danger btn-sm item_delete tooltip-bottom" data-m="${e.meeting}" data-test="${e.test}"><i class="fas fa-trash fa-fw"></i></a>`}}]}),$("#my_tests").DataTable({responsive:!0,ajax:{url:`${u}/student_single/get_tests?pin=${pin}`,dataSrc:""},columns:[{data:"meeting",render:function(e,t,a,s){return`<a target="_blank" href="test?pin=${pin}&meeting=${e}">${e}</a>`}},{data:{course_date:"course_date",meeting:"meeting"},render:function(e,t,a){return`<a target="_blank" href="test?pin=${pin}&meeting=${e.meeting}">${$.format.date(e.course_date,"E, MMM/dd/yy, H:mm")}</a>`}},{data:{teacher:"teacher",meeting:"meeting"},render:function(e,t,a,s){return`<a target="_blank" href="test?pin=${pin}&meeting=${e.meeting}">${e.teacher}</a>`}},{data:{duration:"duration",meeting:"meeting"},render:function(e,t,a,s){return`<a target="_blank" href="test?pin=${pin}&meeting=${e.meeting}">${e.duration} minutes</a>`}},{data:{material:"material",meeting:"meeting"},render:function(e,t,a,s){return`<a target="_blank" href="test?pin=${pin}&meeting=${e.meeting}">${e.material}</a>`}},{data:{evaluation:"evaluation",meeting:"meeting"},render:function(e,t,a,s){return`<a target="_blank" href="test?pin=${pin}&meeting=${e.meeting}">${e.evaluation}</a>`}},{data:{test:"test",test_name:"test_name",meeting:"meeting"},render:function(e,t,a,s){return"Pre Spoken"==e.test_name||"Pre Written"==e.test_name?`<a target="_blank" href="test?pin=${pin}&meeting=${e.meeting}">${e.test_name}</a>`:`<a target="_blank" href="test?pin=${pin}&meeting=${e.meeting}">${e.test}</a>`}}]}),$("select, input, textarea").on("focus",function(){$(this).css("background-color","white"),$("#course_feedback, #course_feedback, #edit_student_feedback").removeClass("alert alert-danger"),$("#course_feedback, #course_feedback, #edit_student_feedback").html("")}),$("#edit_course_title").on("click",function(){$(".item_edit").fadeOut("fast"),$(".item_edit").fadeIn("fast")}),$("#add_course_title").on("click",function(){$("#new_session_btn").fadeOut("100"),$("#new_session_btn").fadeIn("200"),$("#new_session_btn").fadeOut("100"),$("#new_session_btn").fadeIn("200")}),$("#ma").on("focus",function(){$("#ma_prev").fadeIn("slow"),$("#ev_prev").fadeOut("fast"),$(this).on("blur",function(){$("#ma_prev").fadeOut("fast")})}),$("#ev").on("focus",function(){$("#ev_prev").fadeIn("slow"),$("#ma_prev").fadeOut("fast"),$(this).on("blur",function(){$("#ev_prev").fadeOut("fast")})}),$("#new_session_btn").on("click",function(){var e=new Date,t=$.format.date(e,"yyyy-MM-ddTHH:mm"),a="New Session";$("#course_header").html(a),$("#btn_update").hide(),$("#btn_save").show(),$("#course_form").toggle("fast"),$('[name="cd"]').val(t),$('[name="tc"]').val(teacher),$.ajax({type:"post",url:`${u}/student_single/get_meeting`,data:{pin:pin},dataType:"json",success:function(e){if(""==e)$("#me").val(1);else{var t=Number(e[0].meeting),t=t+1;$("#me").val(t)}}}),$("#me").removeAttr("disabled"),$("#du").val(""),$("#ma").val(""),$("#ma_prev").html(""),$("#ma_html").val(""),$("#ev").val(""),$("#ev_prev").html(""),$("#ev_html").val(""),$("#co").val(""),$("#wr").val(""),$("#sp").val(""),$("#test").removeAttr("checked"),$("#course_div").removeClass("col-7"),$("#course_div").addClass("col"),$("#test_div").css("display","none"),$("#test").on("click",function(){$(this).is(":checked")?($("#course_div").removeClass("col"),$("#course_div").addClass("col-7"),$("#test_div").addClass("col-5"),$("#test_div").fadeIn("slow"),$('select[name="tn"]').on("change",function(){var e=$(this).val();"Remedial"==e?$('select[name="otn"], select[name="ot"]').removeAttr("disabled"):($('select[name="otn"], select[name="ot"]').attr("disabled","disabled"),$('select[name="otn"], select[name="ot"]').val(""))})):($("#course_div").removeClass("col-7"),$("#course_div").addClass("col"),$("#test_div").removeClass("col-5"),$("#test_div").fadeOut("fast"))}),$("#course_form").on("click",".close_course",function(){$("#course_form").fadeOut("slow")})}),$("#btn_save").on("click",function(){var e=pin,t=$("#me").val(),a=$("#cd").val(),c=$("#tc").val(),l=$("#du").val(),o=$("textarea.mdhtmlform-html").val();co=$("#co").val(),ev=$("#ev_html").val(),w=$("#wr").val(),s=$("#sp").val(),test="",tnu=$("#tnu").val(),tn=$("#tn").val(),otn=$("#otn").val(),ot=$("#ot").val(),after_teaching="yes",bgc="background-color",clr="pink",""==t||""==a||""==c||""==l||""==o||""==ev?(""==t&&$("#me").css(bgc,clr),""==a&&$("#cd").css(bgc,clr),""==c&&$("#tc").css(bgc,clr),""==l&&$("#du").css(bgc,clr),""==o&&$("#ma").css(bgc,clr),""==ev&&$("#ev").css(bgc,clr),$("#course_feedback").addClass("alert alert-danger"),$("#course_feedback").html("Please fill out all required fields!")):isNaN(t)?($("#me").css(bgc,clr),$("#course_feedback").addClass("alert alert-danger"),$("#course_feedback").html("Meeting field must only be numbers!")):isNaN(w)?($("#wr").css(bgc,clr),$("#course_feedback").addClass("alert alert-danger"),$("#course_feedback").html("Assessment must only be numbers!")):isNaN(s)?($("#sp").css(bgc,clr),$("#course_feedback").addClass("alert alert-danger"),$("#course_feedback").html("Assessment must only be numbers!")):$.ajax({type:"post",url:`${u}/student_single/meeting_avail`,data:{p:e,m:t},success:function(r){"true"==r?($("#me").css(bgc,clr),$("#course_feedback").addClass("alert alert-danger"),$("#course_feedback").html("Meeting with this number has already been conducted before!")):$("#test").is(":checked")?""==tnu?($("#course_feedback").addClass("alert alert-danger"),$("#course_feedback").html("Please complete test details!"),$("#tnu").css(bgc,clr)):""==tn?($("#course_feedback").addClass("alert alert-danger"),$("#course_feedback").html("Please complete test details!"),$("#tn").css(bgc,clr)):"Remedial"!=tn?(test=tnu+" "+tn,$.ajax({type:"post",url:`${u}/student_single/test_avail`,data:{p:e,test:test},success:function(r){"true"==r?($("#course_feedback").addClass("alert alert-danger"),$("#course_feedback").html("<em>"+test+"</em> has been conducted before!"),$("#tnu, #tn").css(bgc,clr)):(n(e,t,a,c,l,o,co,ev,w,s,test,tnu,tn,otn,ot,after_teaching),d(e,t))}})):""==otn?($("#course_feedback").addClass("alert alert-danger"),$("#course_feedback").html("Please complete the test details!"),$("#otn").css(bgc,clr)):""==ot?($("#course_feedback").addClass("alert alert-danger"),$("#course_feedback").html("Please complete the test details!"),$("#ot").css(bgc,clr)):(test=tnu+" "+tn+" of "+otn+" "+ot,$.ajax({type:"post",url:`${u}/student_single/test_avail`,data:{p:e,test:test},success:function(r){"true"==r?($("#course_feedback").addClass("alert alert-danger"),$("#course_feedback").html("<em>"+test+"</em> has been conducted before!"),$("#tnu, #tn, #otn, #ot").css(bgc,clr)):(n(e,t,a,c,l,o,co,ev,w,s,test,tnu,tn,otn,ot,after_teaching),d(e,t))}})):(test=tnu=tn=otn=ot="",n(e,t,a,c,l,o,co,ev,w,s,test,tnu,tn,otn,ot,after_teaching))}})}),$("#show_course").on("click",".item_edit",function(){var e=$(this).data("m"),t=$.format.date($(this).data("cd"),"yyyy-MM-ddTHH:mm"),a=$(this).data("tc"),s=$(this).data("du"),n=l($(this).data("ma")),d=$(this).data("co"),c=l($(this).data("ev")),o=$(this).data("w"),r=$(this).data("s"),i=($(this).data("test"),$(this).data("tnu")),u=$(this).data("tn"),p=$(this).data("otn"),m=$(this).data("ot"),_="Edit Recorded Session";$("#btn_save").hide(),$("#course_header").html(_),$("#btn_update").show(),$("#course_form").fadeIn("slow"),$("#me").attr("disabled","disabled"),$('[name="me"]').val(e),$('[name="cd"]').val(t),$('[name="tc"]').val(a),$('[name="du"]').val(s),$('[name="ma"]').val(n),$("#ma_prev").html($(this).data("ma")),$("#ma_html").val($(this).data("ma")),$("#ma_prev").show(),$("#ev_prev").html($(this).data("ev")),$("#ev_html").val($(this).data("ev")),$('[name="co"]').val(d),$('[name="ev"]').val(c),$('[name="wr"]').val(o),$('[name="sp"]').val(r),$('[name="tnu"]').val(i),$('[name="tn"]').val(u),$('[name="otn"]').val(p),$('[name="ot"]').val(m),""!=u?($("#test").attr("checked","checked"),$("#course_div").removeClass("col"),$("#course_div").addClass("col-7"),$("#test_div").addClass("col-5"),$("#test_div").css("display","block"),"Remedial"==u&&$('select[name="otn"], select[name="ot"]').removeAttr("disabled")):($("#test").removeAttr("checked","checked"),$("#course_div").removeClass("col-7"),$("#course_div").addClass("col"),$("#test_div").css("display","none")),$("#test").on("click",function(){$(this).is(":checked")?($("#course_div").removeClass("col"),$("#course_div").addClass("col-7"),$("#test_div").addClass("col-5"),$("#test_div").fadeIn("slow"),$('select[name="tn"]').on("change",function(){var e=$(this).val();"Remedial"==e?$('select[name="otn"], select[name="ot"]').removeAttr("disabled"):($('select[name="otn"], select[name="ot"]').attr("disabled","disabled"),$('select[name="otn"], select[name="ot"]').val(""))})):($("#course_div").removeClass("col-7"),$("#course_div").addClass("col"),$("#test_div").removeClass("col-5"),$("#test_div").fadeOut("fast"))}),$("#course_form").on("click",".close_course",function(){$("#course_form").fadeOut("slow")})}),$('select[name="tn"]').on("change",function(){var e=$(this).val();"Remedial"==e?$('select[name="otn"], select[name="ot"]').removeAttr("disabled"):$('select[name="otn"], select[name="ot"]').attr("disabled","disabled")}),$("#btn_update").on("click",function(){var e=pin,t=$("#me").val(),a=$("#cd").val(),s=$("#tc").val(),n=$("#du").val(),c=$("textarea.mdhtmlform-html").val(),l=$("#co").val(),r=$("#ev_html").val(),i=$("#wr").val(),p=$("#sp").val(),m="",_=$("#tnu").val(),f=$("#tn").val(),h=$("#otn").val(),b=$("#ot").val(),v="background-color",y="pink";return m=""!=f?"Remedial"!=f?_+" "+f:_+" "+f+" of "+h+" "+b:"",""==a||""==s||""==n||""==c||""==r?(""==s&&$("#tc").css(v,y),""==a&&$("#cd").css(v,y),""==n&&$("#du").css(v,y),""==c&&$("#ma").css(v,y),""==r&&$("#ev").css(v,y),$("#course_feedback").addClass("alert alert-danger"),$("#course_feedback").html("Please fill out all required fields")):isNaN(i)||isNaN(p)?($("#course_feedback").addClass("alert alert-danger"),$("#course_feedback").html("Assessment can only be number"),isNaN(i)&&$("#wr").css(v,y),isNaN(p)&&$("#sp").css(v,y)):isNaN(n)?($("#course_feedback").addClass("alert alert-danger"),$("#course_feedback").html("Meeting duration can only be numbers"),$("#du").css(v,y)):$("#test").is(":checked")?""==_?($("#tnu").css(v,y),$("#course_feedback").addClass("alert alert-danger"),$("#course_feedback").html("Please complete test details")):""==f?($("#course_feedback").addClass("alert alert-danger"),$("#course_feedback").html("Please complete test details"),$("#tn").css(v,y)):"Remedial"!=f?(m=_+" "+f,$.ajax({url:`${u}/student_single/test_edit_avail`,type:"post",dataType:"json",data:{pin:e,test:m},success:function(u){""!=u&&u[0].meeting!=t?($("#tnu, #tn").css(v,y),$("#course_feedback").addClass("alert alert-danger"),$("#course_feedback").html("This test has been conducted in meeting "+u[0].meeting)):(d(e,t),o(e,t,a,s,n,c,l,r,i,p,m,_,f,h,b))}})):""==h?($("#otn").css(v,y),$("#course_feedback").addClass("alert alert-danger"),$("#course_feedback").html("Please complete test details")):""==b?($("#ot").css(v,y),$("#course_feedback").addClass("alert alert-danger"),$("#course_feedback").html("Please complete test details")):(m=_+" "+f+" of "+h+" "+b,$.ajax({type:"post",url:`${u}/student_single/test_edit_avail`,dataType:"json",data:{pin:e,test:m},success:function(u){""!=u&&u[0].meeting!=t?($("#tnu,#tn,#otn,#ot").css(v,y),$("#course_feedback").addClass("alert alert-danger"),$("#course_feedback").html("This remedial has been conducted in meeting "+u[0].meeting)):(d(e,t),o(e,t,a,s,n,c,l,r,i,p,m,_,f,h,b))}})):(m=_=f=h=b="",o(e,t,a,s,n,c,l,r,i,p,m,_,f,h,b)),!1}),$("#show_course").on("click",".item_delete",function(){var e=$(this).data("m"),t=$(this).data("test");$("#delete_session_modal").modal("show"),$("#m_d").val(e),$("#t_d").val(t)}),$("#btn_delete_session").on("click",function(){var e=$("#m_d").val(),t=$("#t_d").val();""!=t?(r(pin,e),p(pin,e),$("#mycourse").DataTable().ajax.reload(),$("#mytests").DataTable().ajax.reload()):(p(pin,e),$("#mycourse").DataTable().ajax.reload(),$("#mytests").DataTable().ajax.reload()),$("#delete_session_modal").modal("hide")}),$("#btn_save_fsp").on("click",function(){var e=$("#fsp_topic").val(),t=$("#fsp_comment").val(),s="";$('input[name="fsp_result"]').is(":checked")&&(s=$('input[name="fsp_result"]:checked').val()),""==e?($("#nff").addClass("alert alert-danger"),$("#nff").html("Topic can't be empty!"),$("#fsp_topic").css("background-color","pink")):$.ajax({type:"POST",url:`${u}/student_single/add_fsp`,dataType:"JSON",data:{pin:pin,topic:e,fsp_result:s,comment:t},success:function(e){$("#fsp_topic").val(""),$("#fsp_comment").val(""),$('input[name="fsp_result"]').prop("checked",!1),$("#new_fsp_modal").modal("hide"),a()}})}),$("#my_fsp").on("click",".fsp_item_edit",function(){var e=$(this).data("material"),t=$(this).data("comment"),a=$(this).data("fsp_result"),s=$(this).data("id");$("#edit_fsp_modal").modal("show"),$("#fsp_topic_edit").val(e),$("#fsp_comment_edit").val(t),$("#id_edit").val(s),"good"==a?$("#good_edit").prop("checked",!0):"average"==a?$("#average_edit").prop("checked",!0):"need_improvement"==a&&$("#need_improvement_edit").prop("checked",!0)}),$("#btn_update_fsp").on("click",function(){var e=$("#id_edit").val(),t=$("#fsp_topic_edit").val(),s="",n=$("#fsp_comment_edit").val();$('input[name="fsp_result_edit"]').is(":checked")&&(s=$('input[name="fsp_result_edit"]:checked').val()),""==t?($("#nff").addClass("alert alert-danger"),$("#nff").html("Topic can't be empty!"),$("#fsp_topic").css("background-color","pink")):$.ajax({type:"POST",url:`${u}/student_single/update_fsp`,dataType:"JSON",data:{pin:pin,id:e,topic:t,fsp_result:s,comment:n},success:function(e){$("#edit_fsp_modal").modal("hide"),a()}})})});
